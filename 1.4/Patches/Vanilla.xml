<?xml version="1.0" encoding="utf-8" ?>
<Patch>

    <!-- Hide old techs & Remove prerequisites -->

    <!-- Neolithic -->

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <nomatch Class="PatchOperationAdd">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "TreeSowing"
                    or defName = "Cocoa"
                    or defName = "Devilstrand"
                    or defName = "PsychoidBrewing"
                    or defName = "Brewing"
                    or defName = "PassiveCooler"
                    or defName = "Pemmican"
                    or defName = "RecurveBow"
                ]
            </xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
        <match Class="PatchOperationReplace">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "TreeSowing"
                    or defName = "Cocoa"
                    or defName = "Devilstrand"
                    or defName = "PsychoidBrewing"
                    or defName = "Brewing"
                    or defName = "PassiveCooler"
                    or defName = "Pemmican"
                    or defName = "RecurveBow"
                ]/tab
            </xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <nomatch Class="PatchOperationRemove">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "Cocoa"
                ]/prerequisites
            </xpath>
        </nomatch>
        <match Class="PatchOperationRemove">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "Cocoa"
                    or defName = "Brewing"
                ]/prerequisites
            </xpath>
        </match>
    </Operation>

    <!-- remove tags with faction start info so we can apply the start info to new techs that contain this one -->

    <Operation Class="PatchOperationRemove">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "PsychoidBrewing"
                or defName = "TreeSowing"
                or defName = "PassiveCooler"
                or defName = "Pemmican"
                or defName = "RecurveBow"
            ]/tags/li[text()="TribalStart"]
        </xpath>
    </Operation>

    <Operation Class="PatchOperationRemove">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "PassiveCooler"
            ]/tags/li[text()="ClassicStart"]
        </xpath>
    </Operation>

    <!-- Medieval -->

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <nomatch Class="PatchOperationAdd">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "Greatbow"
                    or defName = "ComplexClothing"
                    or defName = "CarpetMaking"
                    or defName = "Smithing"
                    or defName = "Stonecutting"
                    or defName = "LongBlades"
                    or defName = "PlateArmor"
                ]
            </xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
        <match Class="PatchOperationReplace">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "Greatbow"
                    or defName = "CarpetMaking"
                    or defName = "Smithing"
                    or defName = "Stonecutting"
                    or defName = "LongBlades"
                    or defName = "PlateArmor"
                ]/tab
            </xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationAdd">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "ComplexClothing"
                ]
            </xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
    </Operation>
    
    <!-- Conditional because Vanilla Furniture Expanded adds tab -->
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "ComplexFurniture"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "ComplexFurniture"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "ComplexFurniture"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <nomatch Class="PatchOperationRemove">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "Greatbow"
                    or defName = "LongBlades"
                    or defName = "PlateArmor"
                ]/prerequisites
            </xpath>
        </nomatch>
        <match Class="PatchOperationRemove">
            <xpath>
                Defs/ResearchProjectDef[
                       defName = "Greatbow"
                    or defName = "ComplexClothing"
                    or defName = "Smithing"
                    or defName = "LongBlades"
                    or defName = "PlateArmor"
                ]/prerequisites
            </xpath>
        </match>
    </Operation>

    <!-- remove tags with faction start info so we can apply the start info to new techs that contain this one -->

    <Operation Class="PatchOperationRemove">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "ComplexFurniture"
                or defName = "Stonecutting"
                or defName = "ComplexClothing"
            ]/tags/li[text()="ClassicStart"]
        </xpath>
    </Operation>

    <!-- Industrial -->

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "DrugProduction"
                or defName = "PsychiteRefining"
                or defName = "WakeUpProduction"
                or defName = "GoJuiceProduction"
                or defName = "PenoxycylineProduction"
                or defName = "Electricity"
                or defName = "Batteries"
                or defName = "BiofuelRefining"
                or defName = "WatermillGenerator"
                or defName = "NutrientPaste"
                or defName = "SolarPanels"
                or defName = "AirConditioning"
                or defName = "Autodoors"
                or defName = "Hydroponics"
                or defName = "PackagedSurvivalMeal"
                or defName = "Firefoam"
                or defName = "IEDs"
                or defName = "GeothermalPower"
                or defName = "SterileMaterials"
                or defName = "ColoredLights"
                or defName = "Machining"
                or defName = "SmokepopBelt"
                or defName = "Gunsmithing"
                or defName = "FlakArmor"
                or defName = "Mortars"
                or defName = "BlowbackOperation"
                or defName = "GasOperation"
                or defName = "GunTurrets"
                or defName = "MicroelectronicsBasics"
                or defName = "MoisturePump"
                or defName = "HospitalBed"
                or defName = "DeepDrilling"
                or defName = "GroundPenetratingScanner"
                or defName = "TransportPod"
                or defName = "MedicineProduction"
                or defName = "LongRangeMineralScanner"
                or defName = "ShieldBelt"
                or defName = "PrecisionRifling"
                or defName = "HeavyTurrets"
                or defName = "MultibarrelWeapons"
                or defName = "MultiAnalyzer"
                or defName = "VitalsMonitor"
                or defName = "Fabrication"
                or defName = "AdvancedFabrication"
                or defName = "SniperTurret"
                or defName = "FoamTurret"
                or defName = "RocketswarmLauncher"
            ]
        </xpath>
        <value>
            <tab>DuneRef_Hidden</tab>
        </value>
    </Operation>

    <!-- Conditional because EPOE adds tab -->
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "Prosthetics"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "Prosthetics"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "Prosthetics"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <!-- Conditional because Vanilla Furniture Expanded adds tab -->
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "TubeTelevision"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "TubeTelevision"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "TubeTelevision"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <!-- Conditional because Vanilla Furniture Expanded adds tab -->
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "FlatscreenTelevision"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "FlatscreenTelevision"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "FlatscreenTelevision"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationRemove">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "PsychiteRefining"
                or defName = "WakeUpProduction"
                or defName = "GoJuiceProduction"
                or defName = "PenoxycylineProduction"
                or defName = "Batteries"
                or defName = "BiofuelRefining"
                or defName = "WatermillGenerator"
                or defName = "NutrientPaste"
                or defName = "SolarPanels"
                or defName = "AirConditioning"
                or defName = "Autodoors"
                or defName = "Hydroponics"
                or defName = "TubeTelevision"
                or defName = "PackagedSurvivalMeal"
                or defName = "Firefoam"
                or defName = "IEDs"
                or defName = "GeothermalPower"
                or defName = "SterileMaterials"
                or defName = "ColoredLights"
                or defName = "Machining"
                or defName = "SmokepopBelt"
                or defName = "Prosthetics"
                or defName = "Gunsmithing"
                or defName = "FlakArmor"
                or defName = "Mortars"
                or defName = "BlowbackOperation"
                or defName = "GasOperation"
                or defName = "GunTurrets"
                or defName = "MicroelectronicsBasics"
                or defName = "FlatscreenTelevision"
                or defName = "MoisturePump"
                or defName = "HospitalBed"
                or defName = "DeepDrilling"
                or defName = "GroundPenetratingScanner"
                or defName = "TransportPod"
                or defName = "MedicineProduction"
                or defName = "LongRangeMineralScanner"
                or defName = "ShieldBelt"
                or defName = "PrecisionRifling"
                or defName = "HeavyTurrets"
                or defName = "MultibarrelWeapons"
                or defName = "MultiAnalyzer"
                or defName = "VitalsMonitor"
                or defName = "Fabrication"
                or defName = "AdvancedFabrication"
                or defName = "SniperTurret"
                or defName = "FoamTurret"
                or defName = "RocketswarmLauncher"
            ]/prerequisites
        </xpath>
    </Operation>

    <Operation Class="PatchOperationRemove">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "TubeTelevision"
                or defName = "SmokepopBelt"
                or defName = "FlakArmor"
                or defName = "MoisturePump"
                or defName = "HospitalBed"
                or defName = "TransportPod"
                or defName = "LongRangeMineralScanner"
                or defName = "ShieldBelt"
                or defName = "MultiAnalyzer"
                or defName = "SniperTurret"
                or defName = "FoamTurret"
                or defName = "RocketswarmLauncher"
            ]/hiddenPrerequisites
        </xpath>
    </Operation>

    <!-- remove tags with faction start info so we can apply the start info to new techs that contain this one -->

    <Operation Class="PatchOperationRemove">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "Electricity"
                or defName = "NutrientPaste"
                or defName = "AirConditioning"
            ]/tags/li[text()="ClassicStart"]
        </xpath>
    </Operation>

    <!-- Spacer -->

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "Cryptosleep"
                or defName = "ReconArmor"
                or defName = "PoweredArmor"
                or defName = "ChargedShot"
            ]
        </xpath>
        <value>
            <tab>DuneRef_Hidden</tab>
        </value>
    </Operation>

    <!-- Conditional because SoS2 adds tab -->
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "ShipBasics"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "ShipBasics"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "ShipBasics"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "ShipReactor"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "ShipReactor"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "ShipReactor"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "ShipEngine"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "ShipEngine"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "ShipEngine"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "ShipComputerCore"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "ShipComputerCore"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "ShipComputerCore"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "ShipSensorCluster"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "ShipSensorCluster"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "ShipSensorCluster"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "ShipCryptosleep"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "ShipCryptosleep"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "ShipCryptosleep"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <!-- Conditional because EPOE adds tab -->
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ResearchProjectDef[defName = "Bionics"]/tab</xpath>
        <match Class="PatchOperationReplace">
            <xpath>Defs/ResearchProjectDef[defName = "Bionics"]/tab</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/ResearchProjectDef[defName = "Bionics"]</xpath>
            <value>
                <tab>DuneRef_Hidden</tab>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationRemove">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "Cryptosleep"
                or defName = "ReconArmor"
                or defName = "PoweredArmor"
                or defName = "ChargedShot"
                or defName = "Bionics"
                or defName = "ShipBasics"
                or defName = "ShipSensorCluster"
                or defName = "ShipCryptosleep"
                or defName = "ShipReactor"
                or defName = "ShipEngine"
                or defName = "ShipComputerCore"
            ]/prerequisites
        </xpath>
    </Operation>

    <Operation Class="PatchOperationRemove">
        <xpath>
            Defs/ResearchProjectDef[
                   defName = "ReconArmor"
                or defName = "PoweredArmor"
                or defName = "ChargedShot"
                or defName = "Bionics"
            ]/hiddenPrerequisites
        </xpath>
    </Operation>

    <!-- Moving Individual items to different techs -->

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/TerrainDef[
                   defName = "Bridge"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Construction</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "Stool"
                or defName = "Table1x2c"
                or defName = "Table2x2c"
                or defName = "Table2x4c"
                or defName = "Table3x3c"
                or defName = "TrapSpike"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Woodworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <nomatch Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "TableSculpting"
                ]
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Woodworking</li>
                </researchPrerequisites>
            </value>
        </nomatch>
        <match Class="PatchOperationReplace">
            <xpath>
                Defs/ThingDef[
                       defName = "TableSculpting"
                ]/researchPrerequisites
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Woodworking</li>
                </researchPrerequisites>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "TableButcher"
                or defName = "AnimalSleepingBox"
                or defName = "EggBox"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Woodworking</li>
                <li>DuneRef_AnimalHusbandry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <nomatch Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "TableButcher"
                ]
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Woodworking</li>
                    <li>DuneRef_AnimalHusbandry</li>
                </researchPrerequisites>
            </value>
        </nomatch>
        <match Class="PatchOperationReplace">
            <xpath>
                Defs/ThingDef[
                       defName = "TableButcher"
                ]/researchPrerequisites
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Woodworking</li>
                    <li>DuneRef_AnimalHusbandry</li>
                </researchPrerequisites>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/TerrainDef[
                   defName = "WoodPlankFloor"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Woodworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationReplace">
            <xpath>
                Defs/ThingDef[
                       defName = "FueledStove"
                ]/researchPrerequisites
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Engineering</li>
                </researchPrerequisites>
            </value>
        </match>
        <nomatch Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "FueledStove"
                ]
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Engineering</li>
                </researchPrerequisites>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/TerrainDef[
                   @Name = "FlagstoneBase"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Masonry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Armchair"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_ComplexTextiles</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "RoyalBed"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_ComplexTextiles</li>
                <li>DuneRef_Wealth</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "DiningChair"
                or defName = "Dresser"
                or defName = "EndTable"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Woodworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "Shelf"
                or defName = "ShelfSmall"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_LongTermStorage</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "Bed"
                or defName = "DoubleBed"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Woodworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <!-- <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <nomatch Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "Bed"
                    or defName = "DoubleBed"
                ]
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Woodworking</li>
                </researchPrerequisites>
            </value>
        </nomatch>
        <match Class="PatchOperationReplace">
            <xpath>
                Defs/ThingDef[
                       defName = "Bed"
                    or defName = "DoubleBed"
                ]/researchPrerequisites
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Woodworking</li>
                </researchPrerequisites>
            </value>
        </match>
    </Operation> -->

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Vent"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Engineering</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "ToolCabinet"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Industrialization</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "ElectricSmithy"
                or defName = "ElectricTailoringBench"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Electronics</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "AnimalBed"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Clothworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Apparel_CollarShirt"
                or defName = "Apparel_Pants"
                or defName = "Apparel_BasicShirt"
                or defName = "Apparel_Tuque"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Clothworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "SteleGrand"
                or defName = "SteleLarge"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Masonry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Sarcophagus"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Woodworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Combat Extended</li>
        </mods>
        <nomatch Class="PatchOperationReplace">
            <xpath>
                Defs/ThingDef[
                       defName = "Weapon_GrenadeFrag"
                    or defName = "Weapon_GrenadeMolotov"
                ]/recipeMaker/researchPrerequisite
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Rifling</li>
                </researchPrerequisites>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "WoodFiredGenerator"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_ScientificTheory</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "ToolCabinet"
                or defName = "PowerConduit"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Education</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "ChemfuelPoweredGenerator"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Apprenticeship</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "SunLamp"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Electronics</li>
                <li>DuneRef_Ecology</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "WindTurbine"
                or defName = "WatermillGenerator"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Electronics</li>
                <li>DuneRef_Composites</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Shell_Smoke"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Chemistry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "TrapIED_AntigrainWarhead"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_NuclearFission</li>
                <li>DuneRef_Combustion</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "TrapIED_EMP"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Plastics</li>
                <li>DuneRef_Combustion</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "TrapIED_Firefoam"
                or defName = "TrapIED_Smoke"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Chemistry</li>
                <li>DuneRef_Combustion</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "BiofuelRefinery"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Apprenticeship</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Weapon_GrenadeEMP"
                or defName = "Shell_EMP"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Plastics</li>
                <li>DuneRef_Computers</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Combat Extended</li>
        </mods>
        <nomatch Class="PatchOperationReplace">
            <xpath>
                Defs/ThingDef[
                       defName = "Gun_EmpLauncher"
                ]/recipeMaker/researchPrerequisite
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Plastics</li>
                    <li>DuneRef_Computers</li>
                    <li>DuneRef_AdvancedBallistics</li>
                </researchPrerequisites>
            </value>
        </nomatch>
    </Operation>

    <!-- to remove rifling that gets added from base class -->
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Combat Extended</li>
        </mods>
        <nomatch Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "Gun_EmpLauncher"
                ]/recipeMaker
            </xpath>
            <value>
                <researchPrerequisite Inherit="False"></researchPrerequisite>
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "CommsConsole"
                or defName = "OrbitalTradeBeacon"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Radio</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "FabricationBench"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Plastics</li>
                <li>DuneRef_Electronics</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Shell_Firefoam"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Chemistry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "FirefoamPopper"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Chemistry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "SolarGenerator"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Electronics</li>
                <li>DuneRef_Composites</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "MegascreenTelevision"
                or defName = "FlatscreenTelevision"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Computers</li>
                <li>DuneRef_Lasers</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "SimpleResearchBench"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_WritingAndCulture</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "HiTechResearchBench"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Computers</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Apparel_FirefoampopPack"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Chemistry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <!-- Remove steel requirement from simple research bench -->
    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "SimpleResearchBench"
            ]/costStuffCount
        </xpath>
        <value>
            <costStuffCount>100</costStuffCount>
        </value>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <nomatch Class="PatchOperationRemove">
            <xpath>
                Defs/ThingDef[
                       defName = "SimpleResearchBench"
                ]/costList
            </xpath>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "Plant_Corn"
                or defName = "Plant_Haygrass"
                or defName = "Plant_Potato"
                or defName = "Plant_Rice"
                or defName = "Plant_Strawberry"
                or defName = "Plant_Healroot"
                or defName = "Plant_Dandelion"
                or defName = "Plant_Daylily"
                or defName = "Plant_Rose"
                or defName = "Plant_Cotton"
                or defName = "Plant_Hops"
                or defName = "Plant_Psychoid"
                or defName = "Plant_Smokeleaf"
                or defName = "Plant_Tinctoria"
            ]/plant
        </xpath>
        <value>
            <sowResearchPrerequisites Inherit="False">
                <li>DuneRef_Agriculture</li>
            </sowResearchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "Wall"
                or defName = "Door"
                or defName = "Column"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Woodworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "Fence"
                or defName = "FenceGate"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_AnimalHusbandry</li>
                <li>DuneRef_Woodworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/TerrainDef[
                   defName = "Concrete"
                or @Name = "FineTileStoneBase"
                or @Name = "TileStoneBase"
                or defName = "PavedTile"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Masonry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "AnimalFlap"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_AnimalHusbandry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "GameOfUrBoard"
                or defName = "HoopstoneRing"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Recreation</li>
            </researchPrerequisites>
        </value>
    </Operation>                

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "ChessTable"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Recreation</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "HorseshoesPin"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Recreation</li>
                <li>DuneRef_Ironworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "BilliardsTable"
                or defName = "PokerTable"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Recreation</li>
                <li>DuneRef_ComplexTextiles</li>
            </researchPrerequisites>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "HandTailoringBench"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Clothworking</li>
                <li>DuneRef_Woodworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "MeleeWeapon_Ikwa"
                or defName = "MeleeWeapon_Gladius"
                or defName = "MeleeWeapon_BreachAxe"
                or defName = "MeleeWeapon_Mace"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Weaponry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/RecipeDef[
                   defName = "CookMealSimple"
                or defName = "CookMealSimpleBulk"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_ComplexCooking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/RecipeDef[
                   defName = "CookMealFine"
                or defName = "CookMealFine_Veg"
                or defName = "CookMealFine_Meat"
                or defName = "CookMealFineBulk"
                or defName = "CookMealFineBulk_Meat"
                or defName = "CookMealFineBulk_Veg"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_ExpandedCulture</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/RecipeDef[
                   defName = "CookMealLavish"
                or defName = "CookMealLavish_Veg"
                or defName = "CookMealLavish_Meat"
                or defName = "CookMealLavishBulk"
                or defName = "CookMealLavishBulk_Meat"
                or defName = "CookMealLavishBulk_Veg"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_ExpandedCulture</li>
                <li>DuneRef_Wealth</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "TableStonecutter"
            ]/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Woodworking</li>
                <li>DuneRef_Stoneworking</li>
            </researchPrerequisites>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "PlantPot"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Agriculture</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "Bedroll"
                or defName = "BedrollDouble"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Clothworking</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationReplace">
            <xpath>
                Defs/ThingDef[
                       defName = "FueledSmithy"
                ]/researchPrerequisites
            </xpath>
            <value>
                <researchPrerequisites Inherit="False">
                    <li>DuneRef_Engineering</li>
                </researchPrerequisites>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/TerrainDef[
                   defName = "GoldTile"
                or defName = "SilverTile"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Currency</li>
                <li>DuneRef_Masonry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/TerrainDef[
                   defName = "MetalTile"
            ]
        </xpath>
        <value>
            <researchPrerequisites Inherit="False">
                <li>DuneRef_Steelworking</li>
                <li>DuneRef_Masonry</li>
            </researchPrerequisites>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Gun_AssaultRifle"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisite Inherit="False">DuneRef_ReplaceableParts</researchPrerequisite>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Gun_MachinePistol"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisite Inherit="False">DuneRef_Rifling</researchPrerequisite>
        </value>
    </Operation>

    <!-- TODO: Patch for only vanilla, some mod is adding the recipemaker here -->
    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Gun_DoomsdayRocket"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisite Inherit="False">DuneRef_BrutalWarfare</researchPrerequisite>
        </value>
    </Operation>

    <!-- Fix bench recipes -->

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "FueledSmithy"
                    or defName = "ElectricSmithy"
                ]
            </xpath>
            <value>
                <modExtensions>
                    <li Class="RecipeInheritance.ThingDefExtension">
                        <inheritRecipesFrom>
                            <li>DankPyon_Anvil</li>
                        </inheritRecipesFrom>
                    </li>
                </modExtensions>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "ElectricTailoringBench"
                ]
            </xpath>
            <value>
                <modExtensions>
                    <li Class="RecipeInheritance.ThingDefExtension">
                        <inheritRecipesFrom>
                            <li>DankPyon_TailorsBench</li>
                        </inheritRecipesFrom>
                    </li>
                </modExtensions>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "FueledStove"
                    or defName = "ElectricStove"
                ]
            </xpath>
            <value>
                <modExtensions>
                    <li Class="RecipeInheritance.ThingDefExtension">
                        <inheritRecipesFrom>
                            <li>DankPyon_RusticCookingTable</li>
                        </inheritRecipesFrom>
                    </li>
                </modExtensions>
            </value>
        </match>
    </Operation>

    <!-- Add linkables -->

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "CraftingSpot"
                    or defName = "FueledSmithy"
                    or defName = "ElectricSmithy"
                ]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities
            </xpath>
            <value>
                <li>DankPyon_Grinder</li>
                <li>DankPyon_Bellows</li>
                <li>DankPyon_QuenchingBucket</li>
                <li>DankPyon_ToolRack</li>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "HandTailoringBench"
                    or defName = "ElectricTailoringBench"
                    or defName = "TableMachining"
                    or defName = "FabricationBench"
                    or defName = "TableStonecutter"
                    or defName = "TableButcher"
                    or defName = "ButcherSpot"
                ]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities
            </xpath>
            <value>
                <li>DankPyon_ToolRack</li>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "FueledStove"
                    or defName = "ElectricStove"
                ]/comps
            </xpath>
            <value>
                <li Class="CompProperties_AffectedByFacilities">
                    <linkableFacilities>
                        <li>DankPyon_RusticCookingTools</li>
                    </linkableFacilities>
                </li>
            </value>
        </match>
    </Operation>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Medieval Overhaul</li>
        </mods>
        <match Class="PatchOperationAdd">
            <xpath>
                Defs/ThingDef[
                       defName = "DrugLab"
                ]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities
            </xpath>
            <value>
                <li>DankPyon_RusticCookingTools</li>
                <li>DankPyon_QuenchingBucket</li>
            </value>
        </match>
    </Operation>

    <!-- Removing items I've designated as superfluous -->

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "MeleeWeapon_Gladius"
                or defName = "MeleeWeapon_Mace"
                or defName = "MeleeWeapon_Ikwa"
            ]/recipeMaker/researchPrerequisites
        </xpath>
        <value>
            <researchPrerequisites Inherit="False" />
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Gun_Revolver"
                or defName = "Gun_Autopistol"
                or defName = "Gun_SniperRifle"
                or defName = "Gun_LMG"
                or defName = "Apparel_FlakVest"
                or defName = "Bow_Recurve"
                or defName = "Bow_Great"
            ]/recipeMaker/researchPrerequisite
        </xpath>
        <value>
            <researchPrerequisites Inherit="False" />
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>
            Defs/ThingDef[
                   defName = "MeleeWeapon_Gladius"
                or defName = "MeleeWeapon_Mace"
                or defName = "MeleeWeapon_Ikwa"
                or defName = "Gun_Revolver"
                or defName = "Gun_Autopistol"
                or defName = "Gun_SniperRifle"
                or defName = "Gun_LMG"
                or defName = "Apparel_FlakVest"
            ]/recipeMaker
        </xpath>
        <value>
            <recipeUsers Inherit="False" />
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>
            Defs/ThingDef[
                   defName = "Bow_Recurve"
                or defName = "Bow_Great"
            ]/recipeMaker/recipeUsers
        </xpath>
        <value>
            <recipeUsers Inherit="False" />
        </value>
    </Operation>

</Patch>