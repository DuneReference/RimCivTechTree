<?xml version="1.0" encoding="utf-8" ?>
<Patch>
	
	<!-- Change Research Prerequisites -->

	<!-- BasicProsthetics -->

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationReplace">
			<xpath>
				Defs/ThingDef[@Name = "Basic"]/recipeMaker/researchPrerequisite
			</xpath>
			<value>
				<researchPrerequisite>DuneRef_Health</researchPrerequisite>
			</value>
		</match>
	</Operation>

	<!-- Prosthetics -->

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationReplace">
			<xpath>
				Defs/ThingDef[defName = "TableProsthetics"]/researchPrerequisites
			</xpath>
			<value>
				<researchPrerequisites>
					<li>DuneRef_Medicine</li>
				</researchPrerequisites>
			</value>
		</match>
	</Operation>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationReplace">
			<xpath>
				Defs/ThingDef[@Name = "Simple"]/recipeMaker/researchPrerequisite
			</xpath>
			<value>
				<researchPrerequisite>DuneRef_Medicine</researchPrerequisite>
			</value>
		</match>
	</Operation>

	<!-- SurrogateOrgans -->
	<!-- SyntheticOrgans -->

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationReplace">
			<xpath>
				Defs/ThingDef[defName = "TableOrgans"]/researchPrerequisites
			</xpath>
			<value>
				<researchPrerequisites>
					<li>DuneRef_Nanotechnology</li>
				</researchPrerequisites>
			</value>
		</match>
	</Operation>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationReplace">
			<xpath>
				Defs/ThingDef[
					   @Name = "Surrogate"
					or @Name = "Synthetic"
				]/recipeMaker/researchPrerequisite
			</xpath>
			<value>
				<researchPrerequisite>DuneRef_Nanotechnology</researchPrerequisite>
			</value>
		</match>
	</Operation>

	<!-- Bionics -->

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationReplace">
			<xpath>
				Defs/ThingDef[@Name = "Bionic"]/recipeMaker/researchPrerequisite
			</xpath>
			<value>
				<researchPrerequisite>DuneRef_Cybernetics</researchPrerequisite>
			</value>
		</match>
	</Operation>

	<!-- AdvancedBionics -->

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationReplace">
			<xpath>
				Defs/ThingDef[@Name = "Advanced"]/recipeMaker/researchPrerequisite
			</xpath>
			<value>
				<researchPrerequisite>DuneRef_Cybernetics</researchPrerequisite>
			</value>
		</match>
	</Operation>

	<!-- AdvancedBionicWarfare -->
	<!-- AdvancedBionicSpine -->
	<!-- ExoskeletonSuits -->
	<!-- RibReplacements -->
	<!-- BionicWarfare -->
	<!-- BionicSpine -->
	<!-- BrainSurgery -->
	<!-- AdvancedBrainSurgery -->

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationRemove">
			<xpath>
				Defs/ThingDef[
					   defName = "AdvancedPowerArm"
					or defName = "AdvancedPowerClaw"
					or defName = "AdvancedBionicSpine"
					or defName = "ExoskeletonSuit"
					or defName = "BionicRibs"
					or defName = "PowerArm"
					or defName = "BionicSpine"
					or defName = "BrainStimulator"
					or defName = "AIChip"
				]/recipeMaker
			</xpath>
		</match>
	</Operation>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationReplace">
			<xpath>
				Defs/RecipeDef[
					   defName = "InstallConstructorCore"
					or defName = "InstallFarmerCore"
					or defName = "InstallMinerCore"
					or defName = "InstallDoctorCore"
					or defName = "InstallDiplomatCore"
					or defName = "InstallBrainStimulator"
					or defName = "InstallAIChip"
					or defName = "InstallAIPersonaCore"
					or defName = "InstallJoywire" 
					or defName = "InstallPainstopper"
				]/researchPrerequisite
			</xpath>
			<value>
				<researchPrerequisite>DuneRef_Cybernetics</researchPrerequisite>
			</value>
		</match>
	</Operation>

	<!-- Remove Old Research Nodes -->

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationRemove">
			<xpath>
				/Defs/ResearchProjectDef[
					   defName = "SurrogateOrgans"
					or defName = "BrainSurgery"
					or defName = "AdvancedBionics"
					or defName = "BionicSpine"
					or defName = "AdvancedBionicSpine"
					or defName = "BionicWarfare"
					or defName = "AdvancedBionicWarfare"
					or defName = "SyntheticOrgans"
					or defName = "AdvancedBrainSurgery"
					or defName = "ExoskeletonSuits"
				]
			</xpath>
		</match>
	</Operation>

	<!-- Still need Basic Prosthetics, Prosthetics, Bionics, RibReplacements (gated by RibReplacements)-->
	<!-- <Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationRemove">
			<xpath>
				/Defs/ResearchProjectDef[
					defName = "BasicProsthetics"
					or defName = "Prosthetics"
					or defName = "SurrogateOrgans"
					or defName = "Bionics"
					or defName = "BrainSurgery"
					or defName = "RibReplacements"
					or defName = "AdvancedBionics"
					or defName = "BionicSpine"
					or defName = "AdvancedBionicSpine"
					or defName = "BionicWarfare"
					or defName = "AdvancedBionicWarfare"
					or defName = "SyntheticOrgans"
					or defName = "AdvancedBrainSurgery"
					or defName = "ExoskeletonSuits"
				]
			</xpath>
		</match>
	</Operation> -->

</Patch>